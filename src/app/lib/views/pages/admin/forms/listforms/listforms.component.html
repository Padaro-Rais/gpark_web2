<div class="dashboard-preview">
  <div class="app-page-header">
    <h2>Gestionnaire des formulaires</h2>
    <div class="app-intro">
      Liste des formulaires créer pour la gestion des différentes modules du
      système.
    </div>
  </div>
  <ng-container *ngIf="state$ | async as vm">
    <clr-datagrid
      #clrDataGrid
      (clrDgRefresh)="onDgRefresh($event)"
      [clrDgLoading]="vm?.performingAction"
      class="datagrid-compact"
      [(clrDgSelected)]="selectedValues"
    >
      <clr-dg-action-bar>
        <drewlabs-datgrid-header
          [refreshButtonDisabled]="vm?.performingAction"
          [createButtonDisabled]="vm?.performingAction"
          (createEvent)="navigateToCreateFormView()"
          (refreshEvent)="onDgHeaderRefresh()"
        >
        <!-- Add a drop down content that show the rest of actions-->
          <clr-dropdown *ngIf="showExportDropdown">
            <button
              type="button"
              [disabled]="vm?.performingAction || selectedValues?.length === 0"
              class="btn btn-sm btn-secondary"
              clrDropdownTrigger
            >
              Exporter
              <clr-icon shape="caret down"></clr-icon>
            </button>
            <clr-dropdown-menu clrPosition="bottom-left" *clrIfOpen>
              <button
                type="button"
                [disabled]="exportButtonDisabled"
                (click)="onExportToExcelEvent()"
                clrDropdownItem
              >
                {{ 'Exporter en JSON' | translate | uppercase }}
              </button>
            </clr-dropdown-menu>
          </clr-dropdown>
          <!--\ Add a drop down content that show the rest of actions-->
        </drewlabs-datgrid-header>
      </clr-dg-action-bar>
      <clr-dg-column>Statut</clr-dg-column>
      <clr-dg-column [clrDgField]="'id'">ID</clr-dg-column>
      <clr-dg-column [clrDgField]="'title'">Titre</clr-dg-column>
      <clr-dg-column [clrDgField]="'description'">Description</clr-dg-column>
      <clr-dg-column [clrDgField]="'endpoint_url'">Endpoint</clr-dg-column>
      <clr-dg-row *ngFor="let item of vm?.dataSource.data">
        <clr-dg-action-overflow>
          <button class="action-item" (click)="navigateToEditView(item)">ÉDITER</button>
        </clr-dg-action-overflow>
        <clr-dg-cell>
          <span
            [class]="
              item?.status ? 'badge badge-success' : 'badge badge-danger'
            "
          ></span>
        </clr-dg-cell>
        <clr-dg-cell>{{ item.id }}</clr-dg-cell>
        <clr-dg-cell>{{ item.title | uppercase }}</clr-dg-cell>
        <clr-dg-cell>{{ item?.description | uppercase }}</clr-dg-cell>
        <clr-dg-cell>{{ item.url }}</clr-dg-cell>
      </clr-dg-row>
      <clr-dg-footer>
        {{ vm?.dataSource?.total }} Formulaires
        <clr-dg-pagination
          [clrDgPageSize]="10"
          #pagination
          [clrDgTotalItems]="vm?.dataSource?.total"
        >
          <clr-dg-page-size
            [clrPageSizeOptions]="[10, 20, 30]"
          ></clr-dg-page-size>
        </clr-dg-pagination>
      </clr-dg-footer>
    </clr-datagrid>
  </ng-container>
</div>
